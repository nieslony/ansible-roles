// The first line is ignored by thunderbird

try {
  if (getenv("USER") != "") {
    // *NIX settings
    var env_user    = getenv("USER");
    var env_home    = getenv("HOME");
  } else {
    // Windows settings
    var env_user    = getenv("USERNAME");
    var env_home    = getenv("HOMEPATH");
  }
  var env_mozdebug= getenv("MOZILLA_DEBUG");

  var user_attrs_file = "file:///home/claas/.thunderbird/user_attrs.cfg";
  pref("autoadmin.global_config_url", user_attrs_file);

  var ldap_server = "{{ ldap_server }}";
  var ldap_port = "{{ ldap_port }}";
  var base_dn = "{{ ldap_base_dn }}";
  var user_dn = "{{ ldap_users_dn }}," + base_dn;

  var imap_server = "{{ imap_server }}";
  var imap_port = "{{ imap_port }}";

  var smtp_server = "{{ smtp_server }}";
  var smtp_port = "{{ smtp_port }}";

  var organization = "{{ organization  }}";
  var server_name = organization;

  //Account
  //lockPref("mail.account.account1.server", "server1");
  lockPref("mail.account.account2.identities", "id1");
  lockPref("mail.account.account2.server", "server2");
  lockPref("mail.accountmanager.accounts", "account2");
  lockPref("mail.accountmanager.defaultaccount", "account2");
  //lockPref("mail.accountmanager.localfoldersserver", "server1");
  lockPref("mail.identity.id1.directoryServer", "ldap_2.servers.LDAPINT");
  lockPref("mail.identity.id1.draft_folder", "imap://" + env_user + "@" + imap_server + "/Drafts");
  lockPref("mail.identity.id1.drafts_folder_picker_mode", "0");
  lockPref("mail.identity.id1.fcc_folder", "imap://" + env_user + "@" + imap_server + "/Sent");
  lockPref("mail.identity.id1.fcc_folder_picker_mode", "0");
  lockPref("mail.identity.id1.organization", organization);
  lockPref("mail.identity.id1.overrideGlobal_Pref", true);
  lockPref("mail.identity.id1.reply_to", "");
  //lockPref("mail.identity.id1.fullName", displayname);
  //lockPref("mail.identity.id1.useremail", mail);

  //IMAP
  lockPref("mail.server.server2.hostname", imap_server);
  lockPref("mail.server.server2.isSecure", true);
  lockPref("mail.server.server2.login_at_startup", true);
  lockPref("mail.server.server2.max_cached_connections", 5);
  lockPref("mail.server.server2.name", server_name);
  lockPref("mail.server.server2.type", "imap");
  lockPref("mail.server.server2.userName", env_user );
  lockPref("mail.server.server2.authMethod", 5);
  lockPref("mail.server.server2.port", imap_port);
  lockPref("mail.server.server2.socketType", 2);

  //SMTP
  lockPref("mail.identity.id1.smtpServer", "smtp1");
  lockPref("mail.identity.id1.stationery_folder", "imap://" + env_user + "@" + imap_server + "/Templates");
  lockPref("mail.identity.id1.tmpl_folder_picker_mode", "0");
  lockPref("mail.identity.id1.valid", true);

  //SMTP general
  lockPref("mail.smtp.defaultserver", "smtp1");
  lockPref("mail.smtpserver.smtp1.auth_method", 0);
  lockPref("mail.smtpserver.smtp1.hostname", smtp_server);
  lockPref("mail.smtpserver.smtp1.port", smtp_port);
  lockPref("mail.smtpserver.smtp1.try_ssl", 1);
  lockPref("mail.smtpserver.smtp1.username", env_user);
  lockPref("mail.smtpservers", "smtp1");
  lockPref("mail.smtpserver.smtp1.authMethod", 5);
  lockPref("mail.startup.enabledMailCheckOnce", true);
  lockPref("mailnews.quotingPrefs.version", 1);
  lockPref("mailnews.ui.threadpane.version", 5);
}
catch(e) {
  displayError("lockedPref", e);
}


